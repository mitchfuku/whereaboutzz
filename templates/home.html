{% extends "layout.html" %}

{% block head %}
<script src="http://maps.google.com/maps/api/js?sensor=false"></script>
{% endblock head %}

{% block content %}
<!-- Banner Content -->
<div id="banner" class="row">
	<div class="12u">
		<section id="map-container">

		</section>
	</div>
</div>
{% endblock content %}

{% block javascript %}
<script>
	$(document).ready(function() {
		try {
			showPosition({{ lat }}, {{ lon }});
		} catch(e) {
			console.log(e);
		}
	});

	function showPosition(lat, lon) {
		console.log("called");
		latlon=new google.maps.LatLng(lat, lon);
		mapholder=document.getElementById('map-container');
		mapholder.style.height='250px';
		mapholder.style.width='100%';
		var myOptions = {
			center:latlon,
			zoom:15,
			mapTypeId:google.maps.MapTypeId.ROADMAP,
			mapTypeControl:false,
			navigationControlOptions:{style:google.maps.NavigationControlStyle.SMALL}
		};
		if ($("body").hasClass("is-mobile")) {
			var latLonStr = lat + "," + lon;
			var m = $(mapholder);
			var url = "http://maps.google.com/maps/api/staticmap?markers=" + latLonStr + "&sensor=false&size=" + m.width() + "x" + m.height()+ "&zoom=" + parseInt(myOptions.zoom) + "&scale=2";
			var image = $(mapholder).append (
				"<img src='" + url + "'style='height'=" + m.height() + " width=" + m.width() + "/>"
			);
			$(image).css({"height" : m.height(), "width" : m.width()});
		} else {
			var map=new google.maps.Map(mapholder,myOptions);
			var marker=new google.maps.Marker({position:latlon,map:map,title:"You are here!"});
		}
	}

	function showError(error) {
		switch(error.code) {
			case error.PERMISSION_DENIED:
			x.innerHTML="User denied the request for Geolocation."
			break;
			case error.POSITION_UNAVAILABLE:
			x.innerHTML="Location information is unavailable."
			break;
			case error.TIMEOUT:
			x.innerHTML="The request to get user location timed out."
			break;
			case error.UNKNOWN_ERROR:
			x.innerHTML="An unknown error occurred."
			break;
		}
	}
</script>
{% endblock javascript %}